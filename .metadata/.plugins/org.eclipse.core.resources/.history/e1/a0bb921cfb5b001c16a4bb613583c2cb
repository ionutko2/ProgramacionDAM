/** Programa capaz de examinar una dirección de correo y devolver una señal dependiendo 
 * si la dirección es correcta o no */
 
import java.util.Scanner;

public class Examen1_4 {
	public static void main(String[] args) {
		Scanner teclado = new Scanner(System.in);
		String direccion = "";
		String partelocal = "";
		String dominio = "";
		int atsign = 0;
		int tamaño = 0;
		int tamañop;
		int tamañod;
		boolean restriccion;
		int ascii1; // No hace falta pasar el char a ascii, lo hice porque no sabía que se podía hacer directamente con el char.
		int ascii2;

		
	do {
		// Leer dirección de correo y validar restriccion
		System.out.println("Escriba su dirección de correo electrónico");
		direccion = teclado.nextLine();
		restriccion = true;
		// Calcular el tamaño de la direccion y encontrar el atsign
		tamaño = direccion.length() - 1;
		atsign = direccion.indexOf("@");
		
		// Restricciones
		if (atsign == -1) {
			restriccion = false; 
		}else {
			// Dividir la parte local y el dominio
			partelocal = direccion.substring(0, atsign);
			dominio = direccion.substring(atsign + 1, tamaño + 1);
			tamañop = partelocal.length();
			tamañod = dominio.length();
		if (direccion.length() <= 254) {
			if (tamañop <= 64 && tamañop > 0) {
				if (tamañod <= 255 && tamañod > 0) {
					// Restricciones para la parte local
					for (int i = 0; i < tamañop; i++) {
						ascii2 = partelocal.charAt(i);
						if (i == 0 && ascii2 == '.') {
							restriccion = false;
						}
						if (ascii2 == '.') {
							if (partelocal.charAt(i + 1) == '.') {
								restriccion = false;
							}
						}
					
						if ((ascii2 >= 'A' && ascii2 <= 'Z') || (ascii2 >= 'a' && ascii2 <= 'z')
							|| (ascii2 >= '0' && ascii2 <= '9') || (ascii2 == '.') || (ascii2 == '-') || (ascii2 == '_')) {
						}else {
							restriccion = false;
						}
					}
					// Restricciones para la parte del dominio
						for (int j = 0; j < tamañod; j++) {
							ascii1 = dominio.charAt(j);
							System.out.println("posicion: " + j);
							System.out.println("letra: " + dominio.charAt(j));
							System.out.println("posicion @ " + atsign);
							if (ascii1 == '.') {
								if (j == atsign + 1) {
									restriccion = false;
								}
								if (j == (tamañod - 1)){
									restriccion = false;
								}else {
									if (dominio.charAt(j + 1) == '.') {
									restriccion = false;
									}
								}
							}
							if ((ascii1 >= 'A' && ascii1 <= 'Z') || (ascii1 >= 'a' && ascii1 <= 'z')
									|| (ascii1 >= '0' && ascii1 <= '9') || (ascii1 == '.')) {
							} else {
								restriccion = false;
							}
						}
					}else {
						restriccion = false;
					}
				} else {
					restriccion = false;
				}
			} else {
				restriccion = false;
			}
		}
		if (restriccion == true) {
			System.out.println("El correo es correcto");
		} else {
			System.out.println("El correo es incorrecto");
		}
	}while (restriccion == false);
	}
}